<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Car Rental Information</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.css"
    />

    <script
      type="text/javascript"
      charset="utf8"
      src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.js"
    ></script>
  </head>

  <body>
    <div class="formDiv">
      <div id="myForm">
        <div class="flex">
          <p>How many day would you like to rent for?</p>
          <div>
            <input
              class="input"
              type="text"
              name="days"
              id="days"
              style="display: none"
            />
            <div>
              <input
                class="button"
                type="button"
                value="30"
                style="cursor: pointer"
                onclick="set30()"
                id="set301"
              />
              <input
                class="button"
                type="button"
                value="60"
                style="cursor: pointer"
                onclick="set60()"
                id="set601"
              />
              <input
                class="button"
                type="button"
                value="90"
                style="cursor: pointer"
                onclick="set90()"
                id="set901"
              />
              <input
                class="button"
                type="button"
                value="330"
                style="cursor: pointer"
                onclick="set330()"
                id="set3301"
              />
              <input
                class="button"
                type="button"
                value="custom"
                style="cursor: pointer"
                onclick="setDayCustom()"
              />
            </div>
          </div>
        </div>
        <div class="flex">
          <p>Start from?</p>
          <div>
            <input
              class="input"
              type="date"
              name="day"
              id="day"
              style="display: none"
            />
            <div>
              <input
                class="button"
                type="button"
                value="Today"
                style="cursor: pointer"
                onclick="setToday()"
                id="setToday"
                disabled
              />
              <input
                class="button"
                type="button"
                value="Tomorrow"
                style="cursor: pointer"
                onclick="setTomorrow()"
                id="setTomorrow"
                disabled
              />
              <input
                class="button"
                type="button"
                value="next month"
                style="cursor: pointer"
                onclick="setMonth()"
                id="setMonth"
                disabled
              />
              <input
                class="button"
                type="button"
                value="custom"
                style="cursor: pointer"
                onclick="setFromCustom()"
              />
            </div>
          </div>
        </div>
        <div>
          <input
            class="button"
            type="button"
            value="Export"
            style="width: 100%"
            onclick="readCsv()"
          />
        </div>
        <div
          style="display: flex; align-items: center; justify-content: center"
        >
          <div class="progressbarBG">
            <div id="scsendbar" class="progressbar"></div>
          </div>
        </div>
        <div
          style="display: flex; align-items: center; justify-content: center"
        >
          <div class="progressbarBG">
            <div id="getbar" class="progressbar"></div>
          </div>
        </div>
        <div
          style="display: flex; align-items: center; justify-content: center"
        >
          <div class="progressbarBG">
            <div id="setbar" class="progressbar"></div>
          </div>
        </div>
        <div style="width: 100%">
          <table id="table_id">
            <thead>
              <tr>
                <th>Code</th>
                <th>State</th>
                <th>City</th>
                <th>Fulladdress</th>
                <th>Class</th>
                <th>Type</th>
                <th>PickDate</th>
                <th>DropDate</th>
                <th>payNowPrice</th>
                <th>payLaterPrice</th>
                <th>Link</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
  </body>
  <style>
    .flex div,
    p {
      display: flex;
      justify-content: center;
    }
    table,
    th,
    td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    .progressbar {
      background-color: green;
      width: 0%;
      height: 30px;
      border-radius: 5px;
      margin: 0px;
    }
    .progressbarBG {
      background-color: grey;
      display: flex;
      width: 100%;
      height: 30px;
      border-radius: 5px;
    }
    * {
      font-family: sans-serif;
      font-size: 20px;
    }
    .formDiv {
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: white;
      border-radius: 50px;
    }
    body {
      background-color: gainsboro;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .input {
      width: 100%;
    }
    div {
      margin: 10px;
    }
    .button {
      cursor: pointer;
      background-color: yellow;
      border-radius: 15px;
      min-width: 80px;
      min-height: 40px;
      border-color: white;
      padding: 10px;
    }
    .button:active {
      background-color: wheat;
    }
  </style>
  <script>
    function set30() {
      $("#days").val(30);
      resetDay();
      $("#set301").css("background-color", "darkorange");
    }
    function set60() {
      $("#days").val(60);
      resetDay();
      $("#set601").css("background-color", "darkorange");
    }
    function set90() {
      $("#days").val(90);
      resetDay();
      $("#set901").css("background-color", "darkorange");
    }
    function set330() {
      $("#days").val(330);
      resetDay();
      $("#set3301").css("background-color", "darkorange");
    }
    function setDayCustom() {
      $("#days").css("display", "block");
      resetDay();
    }
    function resetDay() {
      $("#set301").css("background-color", "yellow");
      $("#set601").css("background-color", "yellow");
      $("#set901").css("background-color", "yellow");
      $("#set3301").css("background-color", "yellow");
    }
    function setToday() {
      var datepicker = $("#day");
      // datepicker.datepicker();
      datepicker.datepicker("setDate", new Date());
    }
    function setFromCustom() {
      $("#day").css("display", "block");
    }
    var requests = [];
    var isSet = false;
    var errcount = 0;
    var canSet = false;
    var responsetotal = 0;
    var sucResponse = 0;
    var failedReq = 0;
    var sucRes = 0;
    var failedRes = 0;
    total = 0;
    var timeInterval = 100;
    function readCsv() {
      var xhr = new XMLHttpRequest();
      xhr.onreadystatechange = function () {
        if (xhr.readyState === XMLHttpRequest.DONE) {
          if (xhr.status === 200) {
            var csvData = xhr.responseText;
            var lines = csvData.split("\n");
            total = lines.length;
            for (var i = 0; i < lines.length; i++) {
              var obj = {};
              var currentLine = lines[i].split(",");
              var link = currentLine[currentLine.length - 1];
              var linksplit = link.split("/");
              var locationCode = linksplit[linksplit.length - 1];
              var req = { code: locationCode, link: link };
              requests.push(req);
            }
          } else {
            console.log("Failed to load CSV file");
          }
        }
      };
      xhr.open("GET", "./location.csv", true);
      xhr.send();
    }
    function min(a, b) {
      if (a > b) return b;
      return a;
    }
  </script>
</html>
